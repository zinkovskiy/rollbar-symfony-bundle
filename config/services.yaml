services:
  _defaults:
    autowire: true
    autoconfigure: true

  SFErTrack\RollbarSymfonyBundle\Service\RollbarReporter: ~

  SFErTrack\RollbarSymfonyBundle\Service\RollbarLoggerFactory:
    arguments:
      $config: '%rollbar.config%'
      $env: '%kernel.environment%'
      $projectDir: '%kernel.project_dir%'

  Rollbar\RollbarLogger:
    public: true
    factory: '@SFErTrack\RollbarSymfonyBundle\Service\RollbarLoggerFactory'

  Monolog\Handler\RollbarHandler:
    tags:
      - { name: monolog.logger, channel: rollbar }

  SFErTrack\RollbarSymfonyBundle\Service\Scrubber\ScrubberFacade: ~
  SFErTrack\RollbarSymfonyBundle\Service\Scrubber\CookieScrubber:
    arguments:
      $scrubFields: '%rollbar.config.scrubber_cookie_fields%'
  SFErTrack\RollbarSymfonyBundle\Service\Scrubber\DefaultScrubber:
    arguments:
      $scrubFields: '%rollbar.config.scrub_fields%'
      $safelist: '%rollbar.config.scrub_safelist%'
      $scrubEnvVariables: '%rollbar.config.scrub_env_variables%'
  SFErTrack\RollbarSymfonyBundle\Service\Scrubber\LocalVarsSecretsScrubber:
    arguments:
      $safelist: '%rollbar.config.scrub_safelist%'
      $scrubEnvVariables: '%rollbar.config.scrub_env_variables%'
  SFErTrack\RollbarSymfonyBundle\Service\CheckIgnore\CheckIgnoreFacade: ~
  SFErTrack\RollbarSymfonyBundle\Service\Exception\ExceptionExtraDataFacade: ~
  SFErTrack\RollbarSymfonyBundle\Service\Exception\ExceptionExtraDataProvider: ~

  sfertrack.serializer.rollbar_serializer_factory:
    autoconfigure: false
    class: 'Symfony\Component\Serializer\Serializer'
    factory: '@SFErTrack\RollbarSymfonyBundle\Serializer\RollbarSerializerFactory'

  SFErTrack\RollbarSymfonyBundle\Service\PersonProvider\PersonProviderFacade:
    class: SFErTrack\RollbarSymfonyBundle\Service\PersonProvider\PersonProviderFacade
    arguments:
      $normalizer: '@sfertrack.serializer.rollbar_serializer_factory'
